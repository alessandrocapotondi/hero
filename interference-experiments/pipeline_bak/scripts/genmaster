#!/bin/zsh

# Some config parameters
export HERO_INSTALL="/scratch/hero/install"

project_root="/home/mmaxim/polybox/PhD/polybench"
size=2048
freq=(
			 50  100  150  200  250  300 \
			#350  400  450  500  550  600 \
			#650  700 \
			#750  800  850  900	950\
			# 1000 1050 1100 1150 1200
			)
gen=(1)
K=(1) # 2 4 8 16 32 64 128 256 512 1024) # 2048 4096 8192 16384)
samples=1024

# Compile once, run remotely
./scripts/compile ${size} 

# Iterate through all configurations
for k in ${K}
do
	echo "K: ${k} out of ${K}"
	prog_dir="${project_root}/data/seq_${size}KB_${k}kernloops"
	mkdir -p ${prog_dir} 
	echo ${prog_dir}
	for f in ${freq} 
	do
		echo "Frequency: ${f} out of ${freq}"
		for g in ${gen}
		do
			echo "Generators: ${g} out of ${gen}"
			ssh root@172.31.182.80 "\
				cd /mnt/mmaxim/crosscompiled;\
				zsh ./run_tg_pi.sh ${k} $((${f}/${g})) ${g} ${samples};\
				" >> ${prog_dir}/${g}_2130_at_$((${f}/${g}))MHz.csv
		done
	done
done
	
exit 0
