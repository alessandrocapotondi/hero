from plptest import *

TestConfig = c = {}

tests = []

def get_test(name, srcs, restrict=None, opt=''):

  opt += ' TEST_SRCS="%s"' % srcs

  return Test(
    name = name,
    commands = [
      Shell('conf', 'make conf %s' % opt),
      Shell('clean', 'make clean %s' % opt),
      Shell('build', 'make all %s' % opt),
      Shell('run',   'make run %s' % opt)
    ],
    restrict=restrict,
    timeout=1000000
   )
  
tests.append(
  get_test(
    'testMCHAN_random_small_001', 
    'random_small.c random_helper.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_basic.c', 
    'testMCHAN_basic.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_4k_crossing.c', 
    'testMCHAN_4k_crossing.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_contention_tcdm.c', 
    'testMCHAN_multi_core_contention_tcdm.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_tx_rx_contention_l2_tcdm.c',
    'testMCHAN_multi_core_tx_rx_contention_l2_tcdm.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_TCDM2TCDM_multi_core_tx_rx_contention.c',
    'testMCHAN_TCDM2TCDM_multi_core_tx_rx_contention.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_basic_FC_TCDM.c',
    'testMCHAN_basic_FC_TCDM.c',
    restrict='config.get("**/fc_tcdm") is not None'
  )
)

tests.append(
  get_test(
    'testMCHAN_pe_basic.c', 
    'testMCHAN_pe_basic.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_multi_trans.c',
    'testMCHAN_multi_core_multi_trans.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_tx_rx_contention_tcdm.c',
    'testMCHAN_multi_core_tx_rx_contention_tcdm.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_TCDM2TCDM_reco_multi_core_tx_rx.c',
    'testMCHAN_TCDM2TCDM_reco_multi_core_tx_rx.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core.c',
    'testMCHAN_multi_core.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_reco.c',
    'testMCHAN_multi_core_reco.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_tx_rx_reco.c',
    'testMCHAN_multi_core_tx_rx_reco.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_TCDM2TCDM_reco_multi_core_tx_rx_contention.c', 
    'testMCHAN_TCDM2TCDM_reco_multi_core_tx_rx_contention.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_contention_l2.c', 
    'testMCHAN_multi_core_contention_l2.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_tx_rx.c', 
    'testMCHAN_multi_core_tx_rx.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_not_incremental.c', 
    'testMCHAN_not_incremental.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_unaligned.c', 
    'testMCHAN_unaligned.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_2D.c', 
    'testMCHAN_2D.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_contention_l2_tcdm.c', 
    'testMCHAN_multi_core_contention_l2_tcdm.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_multi_core_tx_rx_contention_l2.c', 
    'testMCHAN_multi_core_tx_rx_contention_l2.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_TCDM2TCDM_multi_core_tx_rx.c', 
    'testMCHAN_TCDM2TCDM_multi_core_tx_rx.c'
  )
)

tests.append(
  get_test(
    'testMCHAN_pe_fc_basic.c', 
    'testMCHAN_pe_fc_basic.c',
    opt="fc=1 cluster=1"
  )
)

c['tests'] = tests
